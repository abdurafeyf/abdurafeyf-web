---
import HeaderLink from "./HeaderLink.astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../config";
---

<header>
  <div class="header-section">
    <div class="header-frame">
      <h1>{SITE_TITLE}</h1>
      <h2>{SITE_DESCRIPTION}</h2>
    </div>
    <div class="header-frame">
      <div class="profile-container">
        <div class="zoomed-circle"></div>
        <!-- Spotify Logo Overlay -->
        <div class="spotify-logo-overlay" id="spotify-trigger">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm4.5 14.424c-.2.326-.626.428-.95.225-2.6-1.588-5.875-1.947-9.727-1.065-.373.085-.742-.133-.827-.506s.133-.742.506-.827c4.259-.976 8.022-.564 10.998 1.223.324.203.426.629.225.95zm1.355-3.014c-.251.407-.787.535-1.194.284-2.977-1.832-7.516-2.362-11.036-1.292-.469.143-.963-.119-1.106-.588s.119-.963.588-1.106c4.094-1.244 9.258-.644 12.748 1.508.407.251.535.787.284 1.194zm.116-3.138c-3.57-2.122-9.468-2.318-12.877-1.282-.562.171-1.156-.146-1.327-.708s.146-1.156.708-1.327c3.902-1.186 10.467-.968 14.617 1.48.49.289.652.923.363 1.413-.289.49-.923.652-1.413.363-.071-.042-.142-.085-.213-.128z"
              fill="#1DB954"></path>
          </svg>
        </div>
      </div>
    </div>
  </div>
</header>

<nav>
  <HeaderLink href="/">home</HeaderLink>
  <HeaderLink href="/posts">posts</HeaderLink>
</nav>

<!-- Spotify Widget with animation capability -->
<div class="spotify-widget" id="spotify-widget">
  <iframe
    src="https://open.spotify.com/embed/track/0mTdeYJwG6SasLfebdihpH?utm_source=generator&theme=0"
    width="100%"
    height="152"
    frameborder="0"
    allowfullscreen=""
    allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
    loading="lazy"
  >
  </iframe>
</div>

<style>
  /* Spotify Widget Styling */
  .spotify-widget {
    width: 100%;
    max-width: 400px;
    margin: 0 auto 2rem auto;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    z-index: 10;
  }

  .spotify-widget:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
  }

  .spotify-widget iframe {
    border-radius: 12px;
  }

  /* Animated state for moving to top */
  .spotify-widget.animate-to-top {
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    max-width: 350px;
    z-index: 1000;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
  }

  h2 {
    margin: 0.5em 0;
  }

  .profile-container {
    position: relative;
    display: inline-block;
  }

  .zoomed-circle {
    width: 250px;
    height: 250px;
    border-radius: 50%;
    background-image: url("/public/standing-profile.jpg");
    background-size: 150%;
    background-position: center;
    background-repeat: no-repeat;
    position: relative;
  }

  /* Spotify Logo Overlay */
  .spotify-logo-overlay {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 40px;
    height: 40px;
    background: linear-gradient(135deg, #1db954, #1ed760);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(29, 185, 84, 0.3);
    z-index: 100;
  }

  .spotify-logo-overlay:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 16px rgba(29, 185, 84, 0.5);
  }

  .spotify-logo-overlay:active {
    transform: scale(0.95);
  }

  .spotify-logo-overlay svg {
    transition: transform 0.2s ease;
  }

  .spotify-logo-overlay:hover svg {
    transform: rotate(5deg);
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .spotify-widget {
      max-width: 350px;
      margin-bottom: 1.5rem;
    }

    .spotify-widget.animate-to-top {
      max-width: 320px;
      top: 10px;
    }

    .zoomed-circle {
      width: 200px;
      height: 200px;
    }

    .spotify-logo-overlay {
      width: 35px;
      height: 35px;
      top: 10px;
      right: 10px;
    }
  }

  @media (max-width: 480px) {
    .spotify-widget {
      max-width: 300px;
      margin-bottom: 1rem;
    }

    .spotify-widget.animate-to-top {
      max-width: 290px;
    }

    .spotify-widget iframe {
      height: 132px;
    }

    .zoomed-circle {
      width: 150px;
      height: 150px;
    }

    .spotify-logo-overlay {
      width: 30px;
      height: 30px;
      top: 8px;
      right: 8px;
    }

    .spotify-logo-overlay svg {
      width: 20px;
      height: 20px;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const spotifyTrigger = document.getElementById("spotify-trigger");
    const spotifyWidget = document.getElementById("spotify-widget");
    let isAnimated = false;

    spotifyTrigger?.addEventListener("click", function () {
      if (!isAnimated) {
        // Animate to top
        spotifyWidget?.classList.add("animate-to-top");
        isAnimated = true;

        // Optional: Auto-hide after 5 seconds
        setTimeout(() => {
          if (isAnimated) {
            spotifyWidget?.classList.remove("animate-to-top");
            isAnimated = false;
          }
        }, 5000);
      } else {
        // Animate back to original position
        spotifyWidget?.classList.remove("animate-to-top");
        isAnimated = false;
      }
    });

    // Click outside to close
    document.addEventListener("click", function (event) {
      if (
        isAnimated &&
        !spotifyWidget?.contains(event.target as Node) &&
        !spotifyTrigger?.contains(event.target as Node)
      ) {
        spotifyWidget?.classList.remove("animate-to-top");
        isAnimated = false;
      }
    });
  });
</script>
